SELECT COUNT(*) FROM EMPLOYEES WHERE DEPARTMENT_ID = 50;

SELECT COUNT(*) FROM EMPLOYEES WHERE TO_CHAR(HIRE_DATE,'YYYY') = '2007';

SELECT MAX(SALARY),MIN(SALARY),MAX(SALARY) - MIN(SALARY) FROM EMPLOYEES;

SELECT SUM(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID = 100;

SELECT TRUNC(AVG(SALARY),2),DEPARTMENT_ID FROM EMPLOYEES GROUP BY DEPARTMENT_ID;

SELECT COUNTRY_ID, COUNT(CITY) FROM LOCATIONS GROUP BY COUNTRY_ID;

SELECT TRUNC(AVG(SALARY),2), DEPARTMENT_ID FROM EMPLOYEES WHERE  COMMISSION_PCT IS NOT NULL GROUP BY DEPARTMENT_ID;

SELECT TO_CHAR(HIRE_DATE,'YYYY'),COUNT(1) FROM EMPLOYEES GROUP BY TO_CHAR(HIRE_DATE,'YYYY') HAVING COUNT(1) > 10;

SELECT DEPARTMENT_ID,TO_CHAR(HIRE_DATE,'YYYY'),COUNT(*) FROM EMPLOYEES GROUP BY DEPARTMENT_ID,TO_CHAR(HIRE_DATE,'YYYY');

SELECT DISTINCT DEPARTMENT_ID ,COUNT(*) FROM EMPLOYEES WHERE MANAGER_ID IS NOT NULL GROUP BY DEPARTMENT_ID,MANAGER_ID HAVING COUNT(*)>5;


SELECT COUNTRY_NAME, REGION_NAME, CITY FROM COUNTRIES NATURAL JOIN REGIONS NATURAL JOIN LOCATIONS;

SELECT ROUND(AVG(SALARY),2), DEPARTMENT_NAME FROM EMPLOYEES JOIN DEPARTMENTS USING(DEPARTMENT_ID) GROUP BY DEPARTMENT_NAME; --Si se usa un natural join no promedia al empleado con departamento nulo.

  
SELECT A.FIRST_NAME||' '||A.LAST_NAME AS JEFE_DEPARTAMENTO, A.MANAGER_ID AS MANAGER_DE_EMPLEADO,B.DEPARTMENT_NAME,LOCATION_ID, C.CITY FROM EMPLOYEES A 
JOIN DEPARTMENTS B ON (A.EMPLOYEE_ID = B.MANAGER_ID) 
JOIN LOCATIONS C USING(LOCATION_ID);

SELECT A.LAST_NAME,A.FIRST_NAME, A.HIRE_DATE, B.DEPARTMENT_NAME,JOB_TITLE FROM EMPLOYEES A
JOIN DEPARTMENTS B ON (B.DEPARTMENT_ID = A.DEPARTMENT_ID)
JOIN JOBS USING (JOB_ID) WHERE A.HIRE_DATE BETWEEN TO_DATE(2000,'YYYY') AND TO_DATE(2004,'YYYY');

SELECT B.JOB_TITLE, AVG(A.SALARY) AS PROMEDIO FROM EMPLOYEES A JOIN JOBS B USING (JOB_ID) GROUP BY B.JOB_TITLE HAVING AVG(A.SALARY) > 7000;
--EJEMPLO USANDO CLAUSULA WITH
WITH TEMP_SALARIOS AS (SELECT B.JOB_TITLE, AVG(A.SALARY) AS PROMEDIO FROM EMPLOYEES A JOIN JOBS B USING (JOB_ID) GROUP BY B.JOB_TITLE)
SELECT PROMEDIO, JOB_TITLE FROM TEMP_SALARIOS WHERE PROMEDIO > 7000;
--EJEMPLO USANDO CLAUSULA WITH

SELECT REGION_NAME,COUNT(*) AS "NUM DEPAR"
FROM REGIONS NATURAL JOIN COUNTRIES NATURAL JOIN LOCATIONS
NATURAL JOIN DEPARTMENTS
GROUP BY REGION_NAME;

SELECT FIRST_NAME, DEPARTMENT_NAME,COUNTRY_NAME
FROM EMPLOYEES
JOIN DEPARTMENTS USING(DEPARTMENT_ID)
JOIN LOCATIONS USING( LOCATION_ID)
JOIN COUNTRIES USING ( COUNTRY_ID);
