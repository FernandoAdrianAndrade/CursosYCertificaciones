SELECT EMPLEADO.FIRST_NAME ||' ' || EMPLEADO.LAST_NAME AS EMPLEADO, JEFES.FIRST_NAME ||' '||JEFES.LAST_NAME AS JEFE FROM
EMPLOYEES EMPLEADO JOIN EMPLOYEES JEFES ON
EMPLEADO.MANAGER_ID=JEFES.EMPLOYEE_ID;


SELECT DEPARTMENT_NAME, SUM(SALARY) FROM DEPARTMENTS LEFT OUTER JOIN EMPLOYEES USING (DEPARTMENT_ID) GROUP BY DEPARTMENT_NAME;

SELECT CITY, DEPARTMENT_NAME FROM LOCATIONS LEFT JOIN DEPARTMENTS USING (LOCATION_ID) ORDER BY CITY;

SELECT FIRST_NAME ||' '||LAST_NAME AS EMPLEADOS FROM EMPLOYEES WHERE DEPARTMENT_ID IN (
    SELECT DEPARTMENT_ID FROM EMPLOYEES WHERE FIRST_NAME LIKE 'John' AND LAST_NAME LIKE 'Chen');

SELECT * FROM DEPARTMENTS WHERE LOCATION_ID = (
    SELECT LOCATION_ID FROM LOCATIONS WHERE CITY LIKE 'Toronto');

SELECT MANAGER_ID, COUNT(1) FROM EMPLOYEES   GROUP BY MANAGER_ID HAVING MANAGER_ID IN (
    SELECT EMPLOYEE_ID  FROM EMPLOYEES  WHERE EMPLOYEE_ID IN (
        SELECT MANAGER_ID FROM EMPLOYEES A GROUP BY MANAGER_ID HAVING COUNT(1)> 5));

SELECT FIRST_NAME ||' '||LAST_NAME,EMPLOYEE_ID  FROM EMPLOYEES  WHERE EMPLOYEE_ID IN (
    SELECT MANAGER_ID FROM EMPLOYEES A GROUP BY MANAGER_ID HAVING COUNT(1)> 5);

SELECT CITY FROM LOCATIONS WHERE LOCATION_ID IN (
    SELECT LOCATION_ID FROM DEPARTMENTS WHERE DEPARTMENT_ID IN (
        SELECT DEPARTMENT_ID FROM EMPLOYEES WHERE FIRST_NAME LIKE 'Guy' and LAST_NAME like 'Himuro'));
        
SELECT JOB_ID,FIRST_NAME||' '||LAST_NAME AS EMPLEADO,SALARY FROM EMPLOYEES WHERE (JOB_ID,SALARY) IN (
    SELECT JOB_ID,MIN(SALARY) FROM EMPLOYEES GROUP BY JOB_ID);
    
SELECT * FROM EMPLOYEES WHERE SALARY = (
    SELECT MIN(SALARY) FROM EMPLOYEES);
    
SELECT * FROM DEPARTMENTS WHERE DEPARTMENT_ID IN (
    SELECT DEPARTMENT_ID FROM JOB_HISTORY WHERE JOB_ID IN(
        SELECT JOB_ID FROM JOBS WHERE MAX_SALARY > 10000));

SELECT * FROM DEPARTMENTS WHERE DEPARTMENT_ID IN
    (SELECT DEPARTMENT_ID FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING MAX(SALARY)>10000);
    
SELECT * FROM JOBS WHERE JOB_ID IN (
    SELECT JOB_ID FROM EMPLOYEES WHERE HIRE_DATE BETWEEN TO_DATE('2002','YYYY') AND TO_DATE('2003/12/31','YYYY/MM/DD'));

SELECT FIRST_NAME ||' '||LAST_NAME, SALARY, DEPARTMENT_ID FROM EMPLOYEES WHERE SALARY > ANY(
    SELECT MAX(SALARY) FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING DEPARTMENT_ID IN (50,60,70));
    
SELECT * FROM DEPARTMENTS WHERE DEPARTMENT_ID IN(
    SELECT DEPARTMENT_ID FROM EMPLOYEES GROUP BY DEPARTMENT_ID HAVING ROUND(AVG(SALARY)) > 9000);

SELECT FIRST_NAME,DEPARTMENT_NAME,SALARY FROM EMPLOYEES JOIN DEPARTMENTS  USING (DEPARTMENT_ID)  WHERE (SALARY,DEPARTMENT_ID) IN (
    SELECT MAX(SALARY),DEPARTMENT_ID FROM EMPLOYEES GROUP BY DEPARTMENT_ID)
ORDER BY SALARY DESC;
    
SELECT FIRST_NAME,DEPARTMENT_NAME,SALARY FROM EMPLOYEES EMPLEADO JOIN DEPARTMENTS DEPARTAMENTO ON (EMPLEADO.DEPARTMENT_ID = DEPARTAMENTO.DEPARTMENT_ID) WHERE SALARY = (
    SELECT MAX(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID = EMPLEADO.DEPARTMENT_ID GROUP BY DEPARTMENT_ID)
ORDER BY SALARY DESC;

SELECT * FROM EMPLOYEES WHERE SALARY > ALL (SELECT SALARY FROM EMPLOYEES WHERE DEPARTMENT_ID = 100); 

SELECT * FROM EMPLOYEES EMPLEADOS WHERE SALARY =
    (SELECT MAX(SALARY) FROM EMPLOYEES EMPLEADO GROUP BY DEPARTMENT_ID HAVING EMPLEADO.DEPARTMENT_ID = EMPLEADOS.DEPARTMENT_ID);
    
SELECT CITY FROM LOCATIONS LOC WHERE  EXISTS(
    SELECT * FROM DEPARTMENTS WHERE LOCATION_ID = LOC.LOCATION_ID);
    
SELECT REGION_NAME FROM REGIONS REGIONES WHERE NOT EXISTS (
    SELECT * FROM COUNTRIES NATURAL JOIN LOCATIONS NATURAL JOIN DEPARTMENTS WHERE REGION_ID=REGIONES.REGION_ID);